<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TabStash</title>
  <link rel="stylesheet" href="tabstash.css">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1 class="logo">TabStash</h1>
      </div>
      <nav class="sidebar-nav">
        <button class="nav-item active" data-view="all">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="2" y="2" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.3" fill="none"/><path d="M2 6H14" stroke="currentColor" stroke-width="1.3"/></svg>
          All Tabs
          <span class="nav-count" id="nav-all-count">0</span>
        </button>
        <button class="nav-item" data-view="duplicates">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="10" height="10" rx="1.5" stroke="currentColor" stroke-width="1.2" fill="none"/><rect x="5" y="1" width="10" height="10" rx="1.5" stroke="currentColor" stroke-width="1.2" fill="none"/></svg>
          Duplicates
          <span class="nav-count" id="nav-dup-count">0</span>
        </button>
        <button class="nav-item" data-view="archived">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="2" width="14" height="4" rx="1" stroke="currentColor" stroke-width="1.2" fill="none"/><path d="M2 6V13C2 13.6 2.4 14 3 14H13C13.6 14 14 13.6 14 13V6" stroke="currentColor" stroke-width="1.2"/><path d="M6 9H10" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
          Archived
          <span class="nav-count" id="nav-archived-count">0</span>
        </button>
      </nav>

      <div class="sidebar-divider"></div>
      <div class="sidebar-section-label">Collections</div>
      <div id="sidebar-collections" class="sidebar-collections"></div>

      <div class="sidebar-footer">
        <button id="new-collection-btn" class="nav-item nav-item-subtle">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 3V13M3 8H13" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/></svg>
          New collection
        </button>
        <button id="settings-btn" class="nav-item nav-item-subtle">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.2" fill="none"/><path d="M8 1V3M8 13V15M1 8H3M13 8H15M3.05 3.05L4.46 4.46M11.54 11.54L12.95 12.95M12.95 3.05L11.54 4.46M4.46 11.54L3.05 12.95" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/></svg>
          Settings
        </button>
      </div>
    </aside>

    <!-- Main content -->
    <main class="main">
      <!-- Search bar -->
      <header class="main-header">
        <div class="search-bar">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="7" cy="7" r="5" stroke="currentColor" stroke-width="1.4"/>
            <line x1="11" y1="11" x2="15" y2="15" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/>
          </svg>
          <input type="text" id="search" placeholder="Search tabs… (press / to focus)" autocomplete="off" spellcheck="false">
          <kbd class="search-hint">/</kbd>
        </div>
        <div class="header-actions">
          <button id="merge-all-btn" class="btn btn-ghost" title="Merge all duplicates">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 4L8 8L4 12" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 4L8 8L12 12" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Merge duplicates
          </button>
          <button id="save-all-btn" class="btn btn-primary">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 1V13M1 7H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            Save all tabs
          </button>
        </div>
      </header>

      <!-- View title -->
      <div class="view-header">
        <h2 id="view-title" class="view-title">All Tabs</h2>
        <span id="view-count" class="view-count"></span>
      </div>

      <!-- Content area -->
      <div id="content" class="content"></div>

      <!-- Empty state -->
      <div id="empty-state" class="empty-state hidden">
        <div class="empty-icon">
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
            <rect x="6" y="10" width="36" height="28" rx="4" stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M6 18H42" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="14" r="1.5" fill="currentColor"/>
            <circle cx="17" cy="14" r="1.5" fill="currentColor"/>
            <circle cx="22" cy="14" r="1.5" fill="currentColor"/>
            <path d="M18 30L22 26L26 30L30 24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p class="empty-title">Save your first tabs</p>
        <p class="empty-sub">Click "Save all tabs" to stash everything open in this window,<br>or use the TabStash popup from the toolbar.</p>
      </div>
    </main>
  </div>

  <!-- Move-to-collection modal -->
  <div id="move-modal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>Move to collection</h3>
        <button class="modal-close" id="move-close-btn">&times;</button>
      </div>
      <div id="move-list" class="modal-body"></div>
    </div>
  </div>

  <!-- Settings overlay -->
  <div id="settings-overlay" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog modal-dialog-wide">
      <div class="modal-header">
        <h3>Settings</h3>
        <button class="modal-close" id="settings-close-btn">&times;</button>
      </div>
      <div class="modal-body settings-body">
        <div class="setting-group">
          <div class="setting-row">
            <div class="setting-info">
              <div class="setting-label">Archive tabs after</div>
              <div class="setting-desc">Automatically archive tabs older than this. Archived tabs are dimmed and excluded from duplicate counts.</div>
            </div>
            <select id="setting-archive-days" class="setting-select">
              <option value="7">7 days</option>
              <option value="30">30 days</option>
              <option value="90">90 days</option>
              <option value="0">Never</option>
            </select>
          </div>
          <div class="setting-row">
            <div class="setting-info">
              <div class="setting-label">Close tabs after saving</div>
              <div class="setting-desc">Automatically close browser tabs once they're stashed.</div>
            </div>
            <select id="setting-close-after" class="setting-select">
              <option value="ask">Ask each time</option>
              <option value="always">Always close</option>
              <option value="never">Never close</option>
            </select>
          </div>
          <div class="setting-row">
            <div class="setting-info">
              <div class="setting-label">Show duplicate warnings</div>
              <div class="setting-desc">Highlight tabs that have been saved more than once.</div>
            </div>
            <label class="toggle">
              <input type="checkbox" id="setting-show-dupes" checked>
              <span class="toggle-track"></span>
            </label>
          </div>
        </div>

        <div class="setting-group">
          <div class="setting-row">
            <div class="setting-info">
              <div class="setting-label">Export all data</div>
              <div class="setting-desc">Download everything as a JSON file for backup.</div>
            </div>
            <button id="setting-export-btn" class="btn btn-secondary">Export JSON</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Command palette (Cmd+K) -->
  <div id="command-palette" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog modal-dialog-narrow palette-dialog">
      <input type="text" id="palette-input" class="palette-input" placeholder="Type a command…" autocomplete="off" spellcheck="false">
      <div id="palette-results" class="palette-results"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

  <script src="../lib/storage.js"></script>
  <script src="tabstash.js"></script>
</body>
</html>
